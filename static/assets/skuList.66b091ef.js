import{_ as M,d as j,r as i,o as H,M as d,a as o,b as B,c as J,e,w as a,u as Q,g as _,f as y,t as W,h as X,j as Y,I as D,k as Z}from"./index.c04f07c6.js";import{a as ee,b as ue,c as te,d as ae}from"./supplierApis.844b4bcf.js";import{l as le,s as oe}from"./skuUtil.2f7f4fd2.js";const ne=y("br",null,null,-1),se={class:"table-container"},re=y("br",null,null,-1),ie=y("br",null,null,-1),ce={name:"SkuList"},de=j({...ce,setup(pe){const n=i({skuGroup:"",skuName:"",sku:"",supportDays:""}),E=i({sortBy:"avg_sell_quantity",descending:!0}),V=[{width:60,colKey:"erp_sku_image_url",title:"\u5546\u54C1\u56FE\u7247",align:"center"},{width:120,colKey:"sku_group",title:"sku\u5206\u7EC4",align:"center",edit:{component:D,props:{autofocus:!0},validateTrigger:"change",abortEditOnEvent:["onEnter","onBlur"],onEdited:async u=>{console.log(u),await k(u.newRowData),await s()},rules:[{required:!0,message:"\u4E0D\u80FD\u4E3A\u7A7A"}],defaultEditable:!1}},{width:120,colKey:"sku_name",title:"\u5546\u54C1\u540D",align:"center",edit:{component:D,props:{autofocus:!0},validateTrigger:"change",abortEditOnEvent:["onEnter","onBlur"],onEdited:async u=>{console.log(u),await k(u.newRowData),await s()},rules:[{required:!0,message:"\u4E0D\u80FD\u4E3A\u7A7A"}],defaultEditable:!1}},{width:120,colKey:"sku",title:"\u5546\u54C1SKU",align:"center"},{width:120,colKey:"erp_sku_name",title:"BigSeller\u5546\u54C1\u540D",align:"center"},{width:120,colKey:"sku_unit_name",title:"\u91C7\u8D2D\u5355\u4F4D",align:"center",edit:{component:D,props:{autofocus:!0},validateTrigger:"change",abortEditOnEvent:["onEnter","onBlur"],onEdited:async u=>{console.log(u),await k(u.newRowData),await s()},rules:[{required:!0,message:"\u4E0D\u80FD\u4E3A\u7A7A"}],defaultEditable:!1}},{width:120,colKey:"sku_unit_quantity",title:"\u5355\u4F4D\u7684SKU\u6570",align:"center",sortType:"all",sorter:!0,edit:{component:Z,props:{autofocus:!0},validateTrigger:"change",abortEditOnEvent:["onEnter","onBlur"],onEdited:async u=>{console.log(u),await k(u.newRowData),await s()},rules:[{required:!0,message:"\u4E0D\u80FD\u4E3A\u7A7A"}],defaultEditable:!1}},{width:120,colKey:"inventory",sortType:"all",sorter:!0,title:"\u5E93\u5B58",align:"center"},{width:120,colKey:"avg_sell_quantity",title:"\u5E73\u5747\u65E5\u9500\u552E\u91CF",align:"center",sortType:"all",sorter:!0},{width:120,colKey:"inventory_support_days",title:"\u5E93\u5B58\u652F\u6491\u5929\u6570",align:"center",sortType:"all",sorter:!0},{width:120,colKey:"shipping_stock_quantity",title:"\u6D77\u8FD0\u4E2D\u7684SKU",align:"center",sortType:"all",sorter:!0}],F=i([]),p=i(!1),m=i(1),h=i(0),g=i(10),K=[10,20,50,100],c=i({visible:!1,skus:""});H(()=>{s(),le()});const T=u=>{E.value=u,s()},U=({current:u,pageSize:t})=>{m.value=u,g.value=t,s()},k=async u=>{try{await ue(u),await d.success("\u66F4\u65B0sku\u6210\u529F\u3002")}catch(t){console.error(t),await d.error(`\u66F4\u65B0sku\u5F02\u5E38: ${t}`)}},q=async()=>{try{const{success_count:u,ignore_count:t,fail_count:w,detail:r}=await te({skus:c.value.skus});console.log("onAddSku response",r),await d.success(`\u6210\u529F\u6DFB\u52A0\uFF1A${u}, \u5931\u8D25\uFF1A${w}\uFF0C \u5FFD\u7565\uFF1A ${t}`),s()}catch(u){console.error(u),await d.error(`\u6DFB\u52A0sku\u5F02\u5E38: ${u}`)}},x=()=>{c.value.visible=!0},z=async()=>{p.value=!0;try{const{update_count:u}=await ae();await d.success(`\u6210\u529F\u540C\u6B65${u}\u4E2Asku`)}catch(u){console.error(u),await d.error(`\u67E5\u8BE2sku\u5F02\u5E38: ${u}`)}p.value=!1},s=async()=>{const u={sku_group:n.value.skuGroup,sku_name:n.value.skuName,sku:n.value.sku,inventory_support_days:n.value.supportDays,current_page:m.value,page_size:g.value,sort:E.value};p.value=!0;try{const t=await ee(u);h.value=t.total,F.value=t.list}catch(t){console.error(t),await d.error(`\u67E5\u8BE2sku\u5F02\u5E38: ${t}`)}p.value=!1};return(u,t)=>{const w=o("t-select"),r=o("t-form-item"),C=o("t-input"),N=o("t-input-number"),v=o("t-button"),f=o("t-space"),S=o("t-form"),b=o("t-col"),A=o("t-row"),$=o("t-image"),G=o("t-table"),O=o("t-pagination"),P=o("t-card"),R=o("t-alert"),I=o("t-textarea"),L=o("t-dialog");return B(),J("div",null,[e(P,null,{default:a(()=>[e(A,null,{default:a(()=>[e(b,{span:12},{default:a(()=>[e(S,{layout:"inline"},{default:a(()=>[e(r,{label:"sku\u5206\u7EC4:",name:"skuGroup"},{default:a(()=>[e(w,{modelValue:n.value.skuGroup,"onUpdate:modelValue":t[0]||(t[0]=l=>n.value.skuGroup=l),options:Q(oe),clearable:"",filterable:"",placeholder:"-\u8BF7\u9009\u62E9\u5546\u54C1\u5206\u7EC4-",style:{width:"150px",display:"inline-block"}},null,8,["modelValue","options"])]),_:1}),e(r,{label:"\u5546\u54C1\u540D:",name:"skuName"},{default:a(()=>[e(C,{modelValue:n.value.skuName,"onUpdate:modelValue":t[1]||(t[1]=l=>n.value.skuName=l),placeholder:"\u5546\u54C1\u540D"},null,8,["modelValue"])]),_:1}),e(r,{label:"\u5546\u54C1SKU:",name:"sku"},{default:a(()=>[e(C,{modelValue:n.value.sku,"onUpdate:modelValue":t[2]||(t[2]=l=>n.value.sku=l),placeholder:"\u5546\u54C1SKU"},null,8,["modelValue"])]),_:1}),e(r,{label:"\u652F\u6491\u5929\u6570:",name:"supportDays"},{default:a(()=>[e(N,{modelValue:n.value.supportDays,"onUpdate:modelValue":t[3]||(t[3]=l=>n.value.supportDays=l),theme:"column"},null,8,["modelValue"])]),_:1}),e(r,null,{default:a(()=>[e(f,{size:"small",style:{"align-items":"center","margin-left":"30px"}},{default:a(()=>[e(v,{theme:"primary",onClick:s},{default:a(()=>[_("\u67E5\u8BE2")]),_:1})]),_:1}),e(f,{size:"small",style:{"align-items":"center","margin-left":"30px"}},{default:a(()=>[e(v,{theme:"success",onClick:x},{default:a(()=>[_("\u6DFB\u52A0SKU")]),_:1})]),_:1}),e(f,{size:"small",style:{"align-items":"center","margin-left":"30px"}},{default:a(()=>[e(v,{theme:"default",variant:"text",onClick:z},{default:a(()=>[_("\u540C\u6B65\u6240\u6709\u5E93\u5B58")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),ne,y("div",se,[e(G,{columns:V,data:F.value,loading:p.value,"show-sort-column-bg-color":!0,sort:E.value,bordered:"",hover:"","row-key":"sku",stripe:"",onSortChange:T},{avg_sell_quantity:a(({row:l})=>[_(W(l.avg_sell_quantity.toFixed(2)),1)]),erp_sku_image_url:a(({row:l})=>[e($,{src:l.erp_sku_image_url,style:{width:"60px",height:"60px"}},null,8,["src"])]),_:1},8,["data","loading","sort"]),e(O,{modelValue:m.value,"onUpdate:modelValue":t[4]||(t[4]=l=>m.value=l),pageSize:g.value,"onUpdate:pageSize":t[5]||(t[5]=l=>g.value=l),"page-size-options":K,total:h.value,class:"pagination",onChange:U},null,8,["modelValue","pageSize","total"])])]),_:1}),c.value.visible?(B(),X(L,{key:0,visible:c.value.visible,"onUpdate:visible":t[7]||(t[7]=l=>c.value.visible=l),"cancel-btn":null,"close-on-esc-keydown":!1,"close-on-overlay-click":!1,"confirm-btn":null,header:"\u6DFB\u52A0SKU","show-overlay":"",width:"60%"},{default:a(()=>[e(R,{message:"\u9700\u8981\u63D0\u524D\u5728bigseller\u6DFB\u52A0\u597Dsku"}),re,e(S,null,{default:a(()=>[e(r,{label:"sku:",name:"supplier_name"},{default:a(()=>[e(I,{modelValue:c.value.skus,"onUpdate:modelValue":t[6]||(t[6]=l=>c.value.skus=l),autosize:{minRows:3,maxRows:5},name:"description",placeholder:"\u9700\u8981\u6DFB\u52A0\u7684sku\u3002\u591A\u4E2A\u6362\u884C"},null,8,["modelValue"])]),_:1})]),_:1}),ie,e(A,null,{default:a(()=>[e(b,{span:9}),e(b,{span:3},{default:a(()=>[e(f,null,{default:a(()=>[e(v,{style:{float:"right"},theme:"primary",onClick:q},{default:a(()=>[_("\u6279\u91CF\u6DFB\u52A0")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["visible"])):Y("v-if",!0)])}}});var ke=M(de,[["__file","/Users/jkguo/workspace/ec-erp-static/src/pages/supply/skuList.vue"]]);export{ke as default};
