import{_ as L,d as H,r as i,o as J,M as _,a as o,b as D,c as Q,e as n,w as l,f as K,g as h,h as B,j as S,k as P,I as F,S as W}from"./index.279c1295.js";import{c as X,s as Y}from"./warehouseApis.569227d2.js";const Z={class:"search-container",style:{"margin-bottom":"16px"}},ee={class:"table-container"},ue={name:"SkuPickingNote"},ae=H({...ue,setup(ne){const U=[{width:60,colKey:"erp_sku_image_url",title:"\u5546\u54C1\u56FE\u7247",align:"center"},{width:60,colKey:"erp_sku_name",title:"sku",align:"center"},{width:80,colKey:"sku",title:"sku",align:"center"},{width:80,colKey:"picking_unit",title:"1\u62E3\u8D27\u5355\u4F4D=\u591A\u5C11sku?",edit:{component:P,props:{autofocus:!0},validateTrigger:"change",abortEditOnEvent:["onEnter","onBlur"],onEdited:async e=>{console.log(e),await p(e.newRowData)},rules:[{required:!0,message:"\u4E0D\u80FD\u4E3A\u7A7A"}],defaultEditable:!1},align:"center"},{width:60,colKey:"picking_unit_name",title:"\u62E3\u8D27\u5355\u4F4D\u540D",edit:{component:F,props:{autofocus:!0},validateTrigger:"change",abortEditOnEvent:["onEnter","onBlur"],onEdited:async e=>{console.log(e),await p(e.newRowData)},rules:[{required:!0,message:"\u4E0D\u80FD\u4E3A\u7A7A"}],defaultEditable:!1},align:"center"},{width:80,colKey:"picking_sku_name",title:"\u62E3\u8D27SKU\u540D",edit:{component:F,props:{autofocus:!0},validateTrigger:"change",abortEditOnEvent:["onEnter","onBlur"],onEdited:async e=>{console.log(e),await p(e.newRowData)},rules:[{required:!0,message:"\u4E0D\u80FD\u4E3A\u7A7A"}],defaultEditable:!1},align:"center"},{width:80,colKey:"support_pkg_picking",title:"\u662F\u5426\u652F\u6301PKG\u6253\u5305",edit:{component:W,props:{options:[{label:"\u5426",value:!1},{label:"\u662F",value:!0}]},abortEditOnEvent:["onEnter","onBlur","onChange"],on:e=>({onChange:u=>{console.log("status changed",e,u)}}),onEdited:async e=>{console.log(e),await p(e.newRowData)},defaultEditable:!0},align:"center"},{width:80,colKey:"pkg_picking_unit",title:"1 PKG=\u591A\u5C11SKU",edit:{component:P,props:{autofocus:!0},validateTrigger:"change",abortEditOnEvent:["onEnter","onBlur"],onEdited:async e=>{console.log(e),await p(e.newRowData)},rules:[],defaultEditable:!1},align:"center"},{width:60,colKey:"pkg_picking_unit_name",title:"PKG\u6253\u5305\u5355\u4F4D\u540D",edit:{component:F,props:{autofocus:!0},validateTrigger:"change",abortEditOnEvent:["onEnter","onBlur"],onEdited:async e=>{console.log(e),await p(e.newRowData)},rules:[],defaultEditable:!1},align:"center"}],b=i([]),f=i(!1),c=i(1),w=i(0),k=i(10),q=[10,20,50,100],g=i(!1),m=i(!1),d=i(null),a=i({sku:"",picking_unit:1,picking_unit_name:"",picking_sku_name:"",support_pkg_picking:!1,pkg_picking_unit:1,pkg_picking_unit_name:""}),G=i({sku:[{required:!0,message:"SKU\u4E0D\u80FD\u4E3A\u7A7A"}],picking_unit:[{required:!0,message:"\u62E3\u8D27\u5355\u4F4D\u6570\u91CF\u4E0D\u80FD\u4E3A\u7A7A"}],picking_unit_name:[{required:!0,message:"\u62E3\u8D27\u5355\u4F4D\u540D\u4E0D\u80FD\u4E3A\u7A7A"}],picking_sku_name:[{required:!0,message:"\u62E3\u8D27SKU\u540D\u4E0D\u80FD\u4E3A\u7A7A"}],support_pkg_picking:[{required:!0,message:"\u8BF7\u9009\u62E9\u662F\u5426\u652F\u6301PKG\u6253\u5305"}]}),E=i("");J(async()=>{await v()});const R=async({current:e,pageSize:u})=>{c.value=e,k.value=u,await v()},A=async()=>{c.value=1,await v()},v=async()=>{const e={current_page:c.value,page_size:k.value,search_sku:E.value};f.value=!0;try{const u=await X(e);w.value=u.total,b.value=u.list}catch(u){console.error(u),await _.error(`\u67E5\u8BE2\u5907\u6CE8\u5F02\u5E38: ${u}`)}f.value=!1},p=async e=>{let u=!0;if(e.picking_unit<=0&&(_.info(`${e.sku} picking_unit \u672A\u586B`),u=!1),e.picking_unit_name===""&&(_.info(`${e.sku} picking_unit_name \u672A\u586B`),u=!1),e.picking_sku_name===""&&(_.info(`${e.sku} picking_sku_name \u672A\u586B`),u=!1),!u)return!1;try{return await Y({manual_mark_sku_list:[e]}),await v(),!0}catch(s){return console.error(s),await _.error(`\u4FDD\u5B58sku\u62E3\u8D27\u5907\u6CE8\u5931\u8D25: ${s}`),!1}},T=()=>{a.value={sku:"",picking_unit:1,picking_unit_name:"",picking_sku_name:"",support_pkg_picking:!1,pkg_picking_unit:1,pkg_picking_unit_name:""},g.value=!0},z=async()=>{try{if(m.value=!0,d.value&&await d.value.validate()!==!0){m.value=!1;return}const e={sku:a.value.sku,picking_unit:a.value.picking_unit,picking_unit_name:a.value.picking_unit_name,picking_sku_name:a.value.picking_sku_name,support_pkg_picking:a.value.support_pkg_picking};a.value.support_pkg_picking?(e.pkg_picking_unit=a.value.pkg_picking_unit,e.pkg_picking_unit_name=a.value.pkg_picking_unit_name):(e.pkg_picking_unit=0,e.pkg_picking_unit_name="pk"),await p(e)&&(g.value=!1,_.success("\u65B0\u589E\u62E3\u8D27\u5907\u6CE8\u6210\u529F"))}catch(e){console.error("\u65B0\u589E\u62E3\u8D27\u5907\u6CE8\u5931\u8D25:",e),_.error("\u65B0\u589E\u62E3\u8D27\u5907\u6CE8\u5931\u8D25")}finally{m.value=!1}},M=()=>{g.value=!1,d.value&&d.value.clearValidate()};return(e,u)=>{const s=o("t-input"),r=o("t-form-item"),C=o("t-button"),V=o("t-form"),N=o("t-image"),O=o("t-table"),x=o("t-pagination"),$=o("t-card"),y=o("t-input-number"),I=o("t-select"),j=o("t-dialog");return D(),Q("div",null,[n($,null,{default:l(()=>[K("div",Z,[n(V,{layout:"inline"},{default:l(()=>[n(r,{label:"SKU\u641C\u7D22"},{default:l(()=>[n(s,{modelValue:E.value,"onUpdate:modelValue":u[0]||(u[0]=t=>E.value=t),placeholder:"\u8BF7\u8F93\u5165SKU\u8FDB\u884C\u641C\u7D22",style:{width:"200px"},onEnter:A,clearable:""},null,8,["modelValue"])]),_:1}),n(r,null,{default:l(()=>[n(C,{theme:"primary",onClick:A},{default:l(()=>[h("\u641C\u7D22")]),_:1}),n(C,{theme:"default",onClick:T},{default:l(()=>[h(" \u65B0\u589E\u62E3\u8D27\u5907\u6CE8 ")]),_:1})]),_:1})]),_:1})]),K("div",ee,[n(O,{columns:U,data:b.value,loading:f.value,bordered:"",hover:"","row-key":"sku",stripe:""},{erp_sku_image_url:l(({row:t})=>[n(N,{src:t.erp_sku_image_url,style:{width:"60px",height:"60px"}},null,8,["src"])]),_:1},8,["data","loading"]),n(x,{modelValue:c.value,"onUpdate:modelValue":u[1]||(u[1]=t=>c.value=t),pageSize:k.value,"onUpdate:pageSize":u[2]||(u[2]=t=>k.value=t),"page-size-options":q,total:w.value,class:"pagination",onChange:R},null,8,["modelValue","pageSize","total"])])]),_:1}),n(j,{visible:g.value,"onUpdate:visible":u[10]||(u[10]=t=>g.value=t),header:"\u65B0\u589E\u62E3\u8D27\u5907\u6CE8",width:"600px","confirm-btn":{content:"\u4FDD\u5B58",loading:m.value},onConfirm:z,onCancel:M},{default:l(()=>[n(V,{ref_key:"addFormRef",ref:d,data:a.value,rules:G.value,"label-align":"left","label-width":"120px"},{default:l(()=>[n(r,{label:"SKU",name:"sku"},{default:l(()=>[n(s,{modelValue:a.value.sku,"onUpdate:modelValue":u[3]||(u[3]=t=>a.value.sku=t),placeholder:"\u8BF7\u8F93\u5165SKU"},null,8,["modelValue"])]),_:1}),n(r,{label:"\u62E3\u8D27\u5355\u4F4D\u6570\u91CF",name:"picking_unit"},{default:l(()=>[n(y,{modelValue:a.value.picking_unit,"onUpdate:modelValue":u[4]||(u[4]=t=>a.value.picking_unit=t),min:1,placeholder:"\u8BF7\u8F93\u51651\u62E3\u8D27\u5355\u4F4D=\u591A\u5C11sku"},null,8,["modelValue"])]),_:1}),n(r,{label:"\u62E3\u8D27\u5355\u4F4D\u540D",name:"picking_unit_name"},{default:l(()=>[n(s,{modelValue:a.value.picking_unit_name,"onUpdate:modelValue":u[5]||(u[5]=t=>a.value.picking_unit_name=t),placeholder:"\u8BF7\u8F93\u5165\u62E3\u8D27\u5355\u4F4D\u540D"},null,8,["modelValue"])]),_:1}),n(r,{label:"\u62E3\u8D27SKU\u540D",name:"picking_sku_name"},{default:l(()=>[n(s,{modelValue:a.value.picking_sku_name,"onUpdate:modelValue":u[6]||(u[6]=t=>a.value.picking_sku_name=t),placeholder:"\u8BF7\u8F93\u5165\u62E3\u8D27SKU\u540D"},null,8,["modelValue"])]),_:1}),n(r,{label:"\u662F\u5426\u652F\u6301PKG\u6253\u5305",name:"support_pkg_picking"},{default:l(()=>[n(I,{modelValue:a.value.support_pkg_picking,"onUpdate:modelValue":u[7]||(u[7]=t=>a.value.support_pkg_picking=t),placeholder:"\u8BF7\u9009\u62E9\u662F\u5426\u652F\u6301PKG\u6253\u5305",options:[{label:"\u5426",value:!1},{label:"\u662F",value:!0}]},null,8,["modelValue"])]),_:1}),a.value.support_pkg_picking?(D(),B(r,{key:0,label:"PKG\u6253\u5305\u5355\u4F4D\u6570\u91CF",name:"pkg_picking_unit",rules:a.value.support_pkg_picking?[{required:!0,message:"PKG\u6253\u5305\u5355\u4F4D\u6570\u91CF\u4E0D\u80FD\u4E3A\u7A7A"}]:[]},{default:l(()=>[n(y,{modelValue:a.value.pkg_picking_unit,"onUpdate:modelValue":u[8]||(u[8]=t=>a.value.pkg_picking_unit=t),min:1,placeholder:"\u8BF7\u8F93\u51651 PKG=\u591A\u5C11SKU"},null,8,["modelValue"])]),_:1},8,["rules"])):S("v-if",!0),a.value.support_pkg_picking?(D(),B(r,{key:1,label:"PKG\u6253\u5305\u5355\u4F4D\u540D",name:"pkg_picking_unit_name",rules:a.value.support_pkg_picking?[{required:!0,message:"PKG\u6253\u5305\u5355\u4F4D\u540D\u4E0D\u80FD\u4E3A\u7A7A"}]:[]},{default:l(()=>[n(s,{modelValue:a.value.pkg_picking_unit_name,"onUpdate:modelValue":u[9]||(u[9]=t=>a.value.pkg_picking_unit_name=t),placeholder:"\u8BF7\u8F93\u5165PKG\u6253\u5305\u5355\u4F4D\u540D"},null,8,["modelValue"])]),_:1},8,["rules"])):S("v-if",!0)]),_:1},8,["data","rules"])]),_:1},8,["visible","confirm-btn"])])}}});var ie=L(ae,[["__file","/Users/jkguo/workspace/ec-erp-static/src/pages/warehouse/skuPickingNote.vue"]]);export{ie as default};
