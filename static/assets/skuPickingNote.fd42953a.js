import{_ as x,d as I,r as o,o as j,M as p,a as l,b as D,c as L,e as t,w as i,f as V,g as H,h as C,j as y,k as K,I as F,S as J}from"./index.1a39350e.js";import{c as Q,s as W}from"./warehouseApis.823249f3.js";const X={class:"action-buttons",style:{"margin-bottom":"16px"}},Y={class:"table-container"},Z={name:"SkuPickingNote"},ee=I({...Z,setup(ue){const B=[{width:60,colKey:"erp_sku_image_url",title:"\u5546\u54C1\u56FE\u7247",align:"center"},{width:60,colKey:"erp_sku_name",title:"sku",align:"center"},{width:80,colKey:"sku",title:"sku",align:"center"},{width:80,colKey:"picking_unit",title:"1\u62E3\u8D27\u5355\u4F4D=\u591A\u5C11sku?",edit:{component:K,props:{autofocus:!0},validateTrigger:"change",abortEditOnEvent:["onEnter","onBlur"],onEdited:async e=>{console.log(e),await s(e.newRowData)},rules:[{required:!0,message:"\u4E0D\u80FD\u4E3A\u7A7A"}],defaultEditable:!1},align:"center"},{width:60,colKey:"picking_unit_name",title:"\u62E3\u8D27\u5355\u4F4D\u540D",edit:{component:F,props:{autofocus:!0},validateTrigger:"change",abortEditOnEvent:["onEnter","onBlur"],onEdited:async e=>{console.log(e),await s(e.newRowData)},rules:[{required:!0,message:"\u4E0D\u80FD\u4E3A\u7A7A"}],defaultEditable:!1},align:"center"},{width:80,colKey:"picking_sku_name",title:"\u62E3\u8D27SKU\u540D",edit:{component:F,props:{autofocus:!0},validateTrigger:"change",abortEditOnEvent:["onEnter","onBlur"],onEdited:async e=>{console.log(e),await s(e.newRowData)},rules:[{required:!0,message:"\u4E0D\u80FD\u4E3A\u7A7A"}],defaultEditable:!1},align:"center"},{width:80,colKey:"support_pkg_picking",title:"\u662F\u5426\u652F\u6301PKG\u6253\u5305",edit:{component:J,props:{options:[{label:"\u5426",value:!1},{label:"\u662F",value:!0}]},abortEditOnEvent:["onEnter","onBlur","onChange"],on:e=>({onChange:u=>{console.log("status changed",e,u)}}),onEdited:async e=>{console.log(e),await s(e.newRowData)},defaultEditable:!0},align:"center"},{width:80,colKey:"pkg_picking_unit",title:"1 PKG=\u591A\u5C11SKU",edit:{component:K,props:{autofocus:!0},validateTrigger:"change",abortEditOnEvent:["onEnter","onBlur"],onEdited:async e=>{console.log(e),await s(e.newRowData)},rules:[],defaultEditable:!1},align:"center"},{width:60,colKey:"pkg_picking_unit_name",title:"PKG\u6253\u5305\u5355\u4F4D\u540D",edit:{component:F,props:{autofocus:!0},validateTrigger:"change",abortEditOnEvent:["onEnter","onBlur"],onEdited:async e=>{console.log(e),await s(e.newRowData)},rules:[],defaultEditable:!1},align:"center"}],b=o([]),E=o(!1),d=o(1),w=o(0),k=o(10),h=[10,20,50,100],c=o(!1),m=o(!1),g=o(null),a=o({sku:"",picking_unit:1,picking_unit_name:"",picking_sku_name:"",support_pkg_picking:!1,pkg_picking_unit:1,pkg_picking_unit_name:""}),P=o({sku:[{required:!0,message:"SKU\u4E0D\u80FD\u4E3A\u7A7A"}],picking_unit:[{required:!0,message:"\u62E3\u8D27\u5355\u4F4D\u6570\u91CF\u4E0D\u80FD\u4E3A\u7A7A"}],picking_unit_name:[{required:!0,message:"\u62E3\u8D27\u5355\u4F4D\u540D\u4E0D\u80FD\u4E3A\u7A7A"}],picking_sku_name:[{required:!0,message:"\u62E3\u8D27SKU\u540D\u4E0D\u80FD\u4E3A\u7A7A"}],support_pkg_picking:[{required:!0,message:"\u8BF7\u9009\u62E9\u662F\u5426\u652F\u6301PKG\u6253\u5305"}]});j(async()=>{await f()});const S=async({current:e,pageSize:u})=>{d.value=e,k.value=u,await f()},f=async()=>{const e={current_page:d.value,page_size:k.value};E.value=!0;try{const u=await Q(e);w.value=u.total,b.value=u.list}catch(u){console.error(u),await p.error(`\u67E5\u8BE2\u5907\u6CE8\u5F02\u5E38: ${u}`)}E.value=!1},s=async e=>{let u=!0;if(e.picking_unit<=0&&(p.info(`${e.sku} picking_unit \u672A\u586B`),u=!1),e.picking_unit_name===""&&(p.info(`${e.sku} picking_unit_name \u672A\u586B`),u=!1),e.picking_sku_name===""&&(p.info(`${e.sku} picking_sku_name \u672A\u586B`),u=!1),!u)return!1;try{return await W({manual_mark_sku_list:[e]}),await f(),!0}catch(_){return console.error(_),await p.error(`\u4FDD\u5B58sku\u62E3\u8D27\u5907\u6CE8\u5931\u8D25: ${_}`),!1}},U=()=>{a.value={sku:"",picking_unit:1,picking_unit_name:"",picking_sku_name:"",support_pkg_picking:!1,pkg_picking_unit:1,pkg_picking_unit_name:""},c.value=!0},q=async()=>{try{if(m.value=!0,g.value&&await g.value.validate()!==!0){m.value=!1;return}const e={sku:a.value.sku,picking_unit:a.value.picking_unit,picking_unit_name:a.value.picking_unit_name,picking_sku_name:a.value.picking_sku_name,support_pkg_picking:a.value.support_pkg_picking};a.value.support_pkg_picking?(e.pkg_picking_unit=a.value.pkg_picking_unit,e.pkg_picking_unit_name=a.value.pkg_picking_unit_name):(e.pkg_picking_unit=0,e.pkg_picking_unit_name="pk"),await s(e)&&(c.value=!1,p.success("\u65B0\u589E\u62E3\u8D27\u5907\u6CE8\u6210\u529F"))}catch(e){console.error("\u65B0\u589E\u62E3\u8D27\u5907\u6CE8\u5931\u8D25:",e),p.error("\u65B0\u589E\u62E3\u8D27\u5907\u6CE8\u5931\u8D25")}finally{m.value=!1}},G=()=>{c.value=!1,g.value&&g.value.clearValidate()};return(e,u)=>{const _=l("t-button"),R=l("t-image"),T=l("t-table"),z=l("t-pagination"),M=l("t-card"),v=l("t-input"),r=l("t-form-item"),A=l("t-input-number"),N=l("t-select"),O=l("t-form"),$=l("t-dialog");return D(),L("div",null,[t(M,null,{default:i(()=>[V("div",X,[t(_,{theme:"primary",onClick:U},{default:i(()=>[H(" \u65B0\u589E\u62E3\u8D27\u5907\u6CE8 ")]),_:1})]),V("div",Y,[t(T,{columns:B,data:b.value,loading:E.value,bordered:"",hover:"","row-key":"sku",stripe:""},{erp_sku_image_url:i(({row:n})=>[t(R,{src:n.erp_sku_image_url,style:{width:"60px",height:"60px"}},null,8,["src"])]),_:1},8,["data","loading"]),t(z,{modelValue:d.value,"onUpdate:modelValue":u[0]||(u[0]=n=>d.value=n),pageSize:k.value,"onUpdate:pageSize":u[1]||(u[1]=n=>k.value=n),"page-size-options":h,total:w.value,class:"pagination",onChange:S},null,8,["modelValue","pageSize","total"])])]),_:1}),t($,{visible:c.value,"onUpdate:visible":u[9]||(u[9]=n=>c.value=n),header:"\u65B0\u589E\u62E3\u8D27\u5907\u6CE8",width:"600px","confirm-btn":{content:"\u4FDD\u5B58",loading:m.value},onConfirm:q,onCancel:G},{default:i(()=>[t(O,{ref_key:"addFormRef",ref:g,data:a.value,rules:P.value,"label-align":"left","label-width":"120px"},{default:i(()=>[t(r,{label:"SKU",name:"sku"},{default:i(()=>[t(v,{modelValue:a.value.sku,"onUpdate:modelValue":u[2]||(u[2]=n=>a.value.sku=n),placeholder:"\u8BF7\u8F93\u5165SKU"},null,8,["modelValue"])]),_:1}),t(r,{label:"\u62E3\u8D27\u5355\u4F4D\u6570\u91CF",name:"picking_unit"},{default:i(()=>[t(A,{modelValue:a.value.picking_unit,"onUpdate:modelValue":u[3]||(u[3]=n=>a.value.picking_unit=n),min:1,placeholder:"\u8BF7\u8F93\u51651\u62E3\u8D27\u5355\u4F4D=\u591A\u5C11sku"},null,8,["modelValue"])]),_:1}),t(r,{label:"\u62E3\u8D27\u5355\u4F4D\u540D",name:"picking_unit_name"},{default:i(()=>[t(v,{modelValue:a.value.picking_unit_name,"onUpdate:modelValue":u[4]||(u[4]=n=>a.value.picking_unit_name=n),placeholder:"\u8BF7\u8F93\u5165\u62E3\u8D27\u5355\u4F4D\u540D"},null,8,["modelValue"])]),_:1}),t(r,{label:"\u62E3\u8D27SKU\u540D",name:"picking_sku_name"},{default:i(()=>[t(v,{modelValue:a.value.picking_sku_name,"onUpdate:modelValue":u[5]||(u[5]=n=>a.value.picking_sku_name=n),placeholder:"\u8BF7\u8F93\u5165\u62E3\u8D27SKU\u540D"},null,8,["modelValue"])]),_:1}),t(r,{label:"\u662F\u5426\u652F\u6301PKG\u6253\u5305",name:"support_pkg_picking"},{default:i(()=>[t(N,{modelValue:a.value.support_pkg_picking,"onUpdate:modelValue":u[6]||(u[6]=n=>a.value.support_pkg_picking=n),placeholder:"\u8BF7\u9009\u62E9\u662F\u5426\u652F\u6301PKG\u6253\u5305",options:[{label:"\u5426",value:!1},{label:"\u662F",value:!0}]},null,8,["modelValue"])]),_:1}),a.value.support_pkg_picking?(D(),C(r,{key:0,label:"PKG\u6253\u5305\u5355\u4F4D\u6570\u91CF",name:"pkg_picking_unit",rules:a.value.support_pkg_picking?[{required:!0,message:"PKG\u6253\u5305\u5355\u4F4D\u6570\u91CF\u4E0D\u80FD\u4E3A\u7A7A"}]:[]},{default:i(()=>[t(A,{modelValue:a.value.pkg_picking_unit,"onUpdate:modelValue":u[7]||(u[7]=n=>a.value.pkg_picking_unit=n),min:1,placeholder:"\u8BF7\u8F93\u51651 PKG=\u591A\u5C11SKU"},null,8,["modelValue"])]),_:1},8,["rules"])):y("v-if",!0),a.value.support_pkg_picking?(D(),C(r,{key:1,label:"PKG\u6253\u5305\u5355\u4F4D\u540D",name:"pkg_picking_unit_name",rules:a.value.support_pkg_picking?[{required:!0,message:"PKG\u6253\u5305\u5355\u4F4D\u540D\u4E0D\u80FD\u4E3A\u7A7A"}]:[]},{default:i(()=>[t(v,{modelValue:a.value.pkg_picking_unit_name,"onUpdate:modelValue":u[8]||(u[8]=n=>a.value.pkg_picking_unit_name=n),placeholder:"\u8BF7\u8F93\u5165PKG\u6253\u5305\u5355\u4F4D\u540D"},null,8,["modelValue"])]),_:1},8,["rules"])):y("v-if",!0)]),_:1},8,["data","rules"])]),_:1},8,["visible","confirm-btn"])])}}});var te=x(ee,[["__file","/Users/jkguo/workspace/ec-erp-static/src/pages/warehouse/skuPickingNote.vue"]]);export{te as default};
